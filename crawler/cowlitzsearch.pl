#!/usr/bin/perl

use warnings;
use strict;
use LWP::UserAgent;
use Data::Dumper;

my $ua = new LWP::UserAgent;
$ua->agent("AgentName/0.1 " . $ua->agent);

my $url = "http://www.cowlitzinfo.net/applications/cowlitzassessorparcelsearch/(S(jwre4e552yhc2t45bii13xyf))/searchcp.aspx?Public=Y";

my $req = new HTTP::Request POST => $url;

my %post = (
    __EVENTARGUMENT=>'Page$10',
__EVENTTARGET=> 'ctl00$cphParcelSearch$gvSearchResults',
__EVENTVALIDATION=>'/wEWMAL6hcL1DwKgp9zeCQLHkvfJBwLt5u2lDgLRgM8yAvev0dEMAuCF87YHAquR3okBAseM9N8GAtOgksYGAsbqp74HAumfnfwNAumfiZEFAumftaYPAumfodsGAumf7WgC6Z/ZjQgC6Z+FkwIC6Z/xtwkC6Z/9lggC6Z/pyw8ClJ63ggIC6523ggIClp63ggIClZ63ggICkJ63ggICwryfswkCrLb7gwgClsSnvgwCia2FlQIC2JHiVALz+sHDBgKCv66DBQKliIz+CgKE4InqBgK/ye/ADAKTq4qhAwLL6q7UAwKKyqqODQLF+tf9AQLE6PfgDALw7pGEDALDwqXOBwL7i5S4AwLEtYmyCgLvmMGQBAKulJm5AwKXqvuGBlKiaxZBq071nYFVyj1GqzK8xCsN',
__PREVIOUSPAGE=>'xQPFU7JQJQvZ6539ywsapYLcq6kVwy9b6eTHuaFmLEclE3wME9gfVZk2yA9dsgHHFvGpkyCOizqofnoe-AKfJw2',
__SCROLLPOSITIONX=>0,
__SCROLLPOSITIONY=>0,
__VIEWSTATE=>'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DxYCHwAFBERJUktkZAIFDw8WAh8ABQJMTmRkAgYPDxYCHwAFBiZuYnNwO2RkAgcPDxYCHwAFBiZuYnNwO2RkAggPDxYCHwAFBUtFTFNPZGQCCQ8PFgIfAAUFOTg2MjZkZAIKDw8WAh8ABQUyMTYyMmRkAgsPZBYSAgEPDxYCHwAFB1IwNTEyNjlkZAIDDw8WAh8ABQI5MGRkAgQPDxYCHwAFCk5JR0hUSEFUQ0hkZAIFDw8WAh8ABQJEUmRkAgYPDxYCHwAFBiZuYnNwO2RkAgcPDxYCHwAFBiZuYnNwO2RkAggPDxYCHwAFBUtFTFNPZGQCCQ8PFgIfAAUFOTg2MjZkZAIKDw8WAh8ABQk2MjgyOTA1NTNkZAIMD2QWEgIBDw8WAh8ABQdSMDQ3MjYxZGQCAw8PFgIfAAUCOTBkZAIEDw8WAh8ABQRWRVlTZGQCBQ8PFgIfAAUCRFJkZAIGDw8WAh8ABQYmbmJzcDtkZAIHDw8WAh8ABQYmbmJzcDtkZAIIDw8WAh8ABQVLRUxTT2RkAgkPDxYCHwAFBTk4NjI2ZGQCCg8PFgIfAAUHNjI5MTIxMmRkAg0PZBYSAgEPDxYCHwAFB1IwMzQ1NjFkZAIDDw8WAh8ABQI5MWRkAgQPDxYCHwAFB0JVUkNIQU1kZAIFDw8WAh8ABQJTVGRkAgYPDxYCHwAFBiZuYnNwO2RkAgcPDxYCHwAFBiZuYnNwO2RkAggPDxYCHwAFBUtFTFNPZGQCCQ8PFgIfAAUFOTg2MjZkZAIKDw8WAh8ABQcyMDQyNTAxZGQCDg9kFhICAQ8PFgIfAAUHUjAzNTk0MWRkAgMPDxYCHwAFAjkxZGQCBA8PFgIfAAUERElSS2RkAgUPDxYCHwAFAkxOZGQCBg8PFgIfAAUGJm5ic3A7ZGQCBw8PFgIfAAUGJm5ic3A7ZGQCCA8PFgIfAAUFS0VMU09kZAIJDw8WAh8ABQU5ODYyNmRkAgoPDxYCHwAFBTIxNjIzZGQCDw9kFhICAQ8PFgIfAAUHUjAzNDY0NWRkAgMPDxYCHwAFAjkxZGQCBA8PFgIfAAUIRE9OQVRJT05kZAIFDw8WAh8ABQJTVGRkAgYPDxYCHwAFBiZuYnNwO2RkAgcPDxYCHwAFBiZuYnNwO2RkAggPDxYCHwAFBUtFTFNPZGQCCQ8PFgIfAAUFOTg2MjZkZAIKDw8WAh8ABQUyMDQ4NmRkAhAPDxYCHgdWaXNpYmxlaGRkAgkPDxYCHwVoZGQCCg9kFgICAQ9kFgJmDw8WAh8ABRNTZWFyY2ggRm9yIFByb3BlcnR5ZGQCBQ9kFgJmD2QWAmYPZBYEZg8PFgIfAAVAVGhpcyBwYWdlIGhhcyBiZWVuIGFjY2Vzc2VkIDIsNDI3LDI3MSB0aW1lcyBzaW5jZSBNYXJjaCA4LCAyMDA1LmRkAgIPDxYCHwAFLE92ZXIgNSw0NjYsNTU4IHNlYXJjaGVzIGhhdmUgYmVlbiBwZXJmb3JtZWQuZGQYAgUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFImN0bDAwJGNwaFBhcmNlbFNlYXJjaCRJbWFnZUJ1dHRvbjIFJWN0bDAwJGNwaFBhcmNlbFNlYXJjaCRndlNlYXJjaFJlc3VsdHMPPCsACgICAgoIAhNkmvljyToRF0pIy8y1SN9NQk7uBok=',
'ctl00$cphParcelSearch$currentSort'=>'STREET_NUMBER',
'ctl00$cphParcelSearch$txtAccount'=>'',
'ctl00$cphParcelSearch$txtCity'=>'kelso',
'ctl00$cphParcelSearch$txtParcelID'=>'',
'ctl00$cphParcelSearch$txtStreetDir'=>'',
'ctl00$cphParcelSearch$txtStreetName'=>'',
'ctl00$cphParcelSearch$txtStreetNumber'=>'',
'ctl00$cphParcelSearch$txtStreetSuffix'=>'',
'ctl00$cphParcelSearch$txtZipCode'=>'',
    );

my @args = map {"$_=$post{$_}"} keys(%post);

printf "using args %s\n", join(" ", @args);
$req->content(@args); #problem
my $res = $ua->request($req);

print $res->content;

